_jsload&&_jsload('oppc', 'BMap.register(function(aV){var aU=aV;var aT=aV.platform;function aW(a6,a2){var aY=a6.srcElement||a6.target,a5=a6.offsetX||a6.layerX||0,a4=a6.offsetY||a6.layerY||0,a1=null,a0=null;if(aY.nodeType!=1){aY=aY.parentNode}while(aY&&aY!=aU.container){if(aY.hashCode){if(l.I(aY.hashCode) instanceof aF){a1=l.I(aY.hashCode)}if(l.I(aY.hashCode) instanceof ay){a0=l.I(aY.hashCode)}}if(!(aY.clientWidth==0&&aY.clientHeight==0&&aY.offsetParent&&aY.offsetParent.nodeName=="TD")&&aY.namespaceURI!="http://www.w3.org/2000/svg"){a5+=aY.offsetLeft||0;a4+=aY.offsetTop||0}else{if(aY.namespaceURI=="http://www.w3.org/2000/svg"&&BMap.DrawerSelector){var aZ=BMap.DrawerSelector.getDrawer(aU);var aX=aZ.getPalette();if(navigator.userAgent.indexOf("Opera")>-1&&aY.tagName!="svg"){var a7=l.I(aY.hashCode);if(a7){var a3=a7.getBounds();a5=a5+aU.pointToPixel(new f(a3.minX,a3.minY)).x;a4=a4+aU.pointToPixel(new f(a3.minX,a3.maxY)).y}break}if(aX&&(!l.Browser.ie||(l.Browser.ie==9&&aY.nodeName.toLowerCase()=="svg"))){a5+=parseFloat(aX.style.left)+aU.offsetX;a4+=parseFloat(aX.style.top)+aU.offsetY}if(l.Browser.ie==9&&aY.nodeName.toLowerCase()!="svg"){a5+=aU.offsetX;a4+=aU.offsetY;break}if(!l.Browser.ie){break}}}aY=aY.offsetParent}a2.offsetX=a5;a2.offsetY=a4;a2.pixel=new aK(a5,a4);a2.point=aU.pixelToPoint(a2.pixel);a2.overlay=a1;a2.infoWindow=a0;return a2}aV.container.onselectstart=function(){return false};l.on(aU.platform,"mousemove",function(aX){if(aU.currentOperation==0){aU.dispatchEvent(aW(aX,new aw("onmousemove").inherit(aX)))}});l.on(aU.platform,"mousedown",function(a0){if(!aU.config.enableMouseDown){return}var a0=window.event||a0;var aZ=aU.temp;aZ.operating=true;var aY=a0.srcElement||a0.target;if(aZ.dragAni){aZ.dragAni.stop();aZ.dragAni=null;aU.dispatchEvent(new aw("onmoveend"))}aZ.tpx=a0.clientX||a0.pageX||0;aZ.tpy=a0.clientY||a0.pageY||0;var aX=aY;while(aX){if(aX==aU.container){break}if(l.hc(aX,"BMap_Marker")){return}aX=aX.parentNode}if(aY.nodeType!=1){aY=aY.parentNode}if(aU.maskLayer.setCapture){aU.maskLayer.setCapture()}aU.dispatchEvent(aW(a0,new aw("onmousedown").inherit(a0)));if(aU.config.enableDragging&&!(aU.currentOperation&aL.drag)&&a0.button!=2){aZ.mx=aZ.tpx;aZ.my=aZ.tpy;aZ.pl=aU.offsetX;aZ.pt=aU.offsetY;aU.currentOperation|=aL.drag;if(aU.temp.curSpotsArray.length==0){aU.platform.style.cursor=aU.config.draggingCursor}else{aU.platform.style.cursor="pointer"}}});l.on(document,"mousemove",function(a0){var a0=window.event||a0;if(!l.Browser.ie){D(a0)}var aZ=aU.temp;var aX=a0.clientX||a0.pageX||0;var a3=a0.clientY||a0.pageY||0;if(aZ.tpx||aZ.tpy){aZ.mox=aX-aZ.tpx;aZ.moy=a3-aZ.tpy}var a1=new Date().getTime(),a2=(a1-aZ.lastLoadTileTime)>40;if(a1-aZ.lastDomMoveTime<18){return}if(a2){aZ.lastLoadTileTime=a1}aZ.lastDomMoveTime=a1;if(aU.currentOperation&aL.drag&&aU.config.enableDragging){var aY=aU.platform.style;if(aY.cursor.replace(/"|\s/g,"")!=aU.config.draggingCursor){aY.cursor=aU.config.draggingCursor}if(!aZ._moved){aU.dispatchEvent(aW(a0,new aw("ondragstart").inherit(a0)));aU.dispatchEvent(new aw("onmovestart"));aZ.dragStartPos=new aK(aX,a3);aZ.dragStartTime=a1}if(aZ.mx==0&&aZ.my==0&&aU.temp.keyboardDrag){aZ.mx=aX;aZ.my=a3;aZ.pl=aU.offsetX;aZ.pt=aU.offsetY}if(aX-aZ.mx!=0||a3-aZ.my!=0){aU.temp._moved=true;aU.dispatchEvent(aW(a0,new aw("ondragging").inherit(a0)));aU._setPlatformPosition(aZ.pl+aX-aZ.mx,aZ.pt+a3-aZ.my,null,a2)}}});l.on(document,"mouseup",function(a0){if(aU.maskLayer.releaseCapture){aU.maskLayer.releaseCapture()}var aY=aU.temp;if(aY.preEnableClickPan){aU.enableClickPan(true)}var a0=window.event||a0,aX=a0.clientX||a0.pageX,a1=a0.clientY||a0.pageY;if(aU.currentOperation&aL.drag&&aU.config.enableDragging){aU.currentOperation^=aL.drag;if(aY.curSpotsArray.length==0){aU.platform.style.cursor=aU.config.defaultCursor}else{aU.platform.style.cursor="pointer"}if(aU.temp._moved){var aZ=aW(a0,new aw("ondragend").inherit(a0));aU.dispatchEvent(aZ);aU._processInertialDragging(new aK(aX,a1))}aY._moved=false}aY.operating=false;if(a0.button==2){aY.tpx=null;aY.tpy=null;aY.mox=0;aY.moy=0}});function i(a0){var aZ=aU.temp,aY=!aZ.mox&&!aZ.moy;if(aZ.rightDblclickTimer){clearTimeout(aZ.rightDblclickTimer);aZ.rightDblclickTimer=null;if(aY){aU.dispatchEvent(aW(a0,new aw("onrightclick").inherit(a0)));aU.currentOperation|=aL.dblclick;aU.dispatchEvent(aW(a0,new aw("onrightdblclick").inherit(a0)));aU.currentOperation^=aL.dblclick}}else{if(aY){aU.dispatchEvent(aW(a0,new aw("onrightclick").inherit(a0)))}var aX=aW(a0,new aw("onrightclickex").inherit(a0));aZ.rightDblclickTimer=setTimeout(function(){aZ.rightDblclickTimer=null;if(aY){aU.dispatchEvent(aX)}},aU.config.clickInterval)}}if(l.Browser.firefox>=4){l.on(aU.container,"mouseup",function(aX){if(aX.button==2){i(aX)}});l.on(aU.container,"contextmenu",function(aX){aC(aX)})}else{l.on(aU.container,"contextmenu",function(aX){i(aX);aC(aX)})}function e(aZ){if(aU.config.enableWheelZoom){var aY=aU.temp;if(aY.dragAni){aY.dragAni.stop();aY.dragAni=null;setTimeout(function(){aU.dispatchEvent(new aw("onmoveend"))},1)}aU.currentOperation|=aL.mousewheel;var aZ=window.event||aZ;aU.lastLevel=aU.zoomLevel;var aX=new aw("onmousewheel");aX.trend=aZ.wheelDelta>=0||aZ.detail<0;if(aX.trend==true&&aU.zoomLevel==aJ[aU.mapType].zoomLevelMax||aX.trend==false&&aU.zoomLevel==aJ[aU.mapType].zoomLevelMin){aU.currentOperation^=aL.mousewheel;D(aZ);return}aW(aZ,aX.inherit(aZ));aU.dispatchEvent(aX);aU.currentOperation^=aL.mousewheel;aZ.returnValue=false;D(aZ)}}l.on(aU.container,"mousewheel",e);if(window.addEventListener){aU.container.addEventListener("DOMMouseScroll",e,false)}l.on(aU.platform,"click",function(a1){var aZ=new aw("onclick"),a0=new aw("onclickex"),aY=aU.temp;aW(a1,aZ.inherit(a1));aW(a1,a0.inherit(a1));if(!aU.currentOperation){var aX=!aY.mox&&!aY.moy;if(aX){aU.dispatchEvent(aZ)}if(!aY._clickTimer){aY._clickTimer=setTimeout(function(){aY._clickTimer=null;if(aX){aU.dispatchEvent(a0)}},aU.config.clickInterval)}}aY.tpx=null;aY.tpy=null;aY.mox=0;aY.moy=0});l.on(aU.platform,"dblclick",function(aY){if(!aU.currentOperation){aU.currentOperation|=aL.dblclick;if(l.Browser.ie){aU.dispatchEvent(aW(aY,new aw("onclick").inherit(aY)))}var aX=aU.temp;if(aX._clickTimer){clearTimeout(aX._clickTimer);aX._clickTimer=null}aU.dispatchEvent(aW(aY,new aw("ondblclick").inherit(aY)));aU.currentOperation^=aL.dblclick}});l.on(document,"mousedown",function(aZ){var aZ=window.event||aZ;var aY=aZ.srcElement||aZ.target;var aX=aU.temp;if(aX.canKeyboard){aX.canKeyboard=aV.container.contains(aY)}else{aX.canKeyboard=aV.platform.contains(aY)}})});C.prototype._processInertialDragging=function(a9){var bc=this;if(!bc.config.enableInertialDragging){bc.dispatchEvent(new aw("onmoveend"));return}var a0=bc.temp;var i=new Date().getTime();if(i-a0.lastDomMoveTime>100){bc.dispatchEvent(new aw("onmoveend"));a0._moved=false;return}else{var ba=a0.dragStartPos,a3=a9,e=v(ba,a3),a7=[a3.x-ba.x>0?1:-1,a3.y-ba.y>0?1:-1],aU=(i-a0.dragStartTime)/1000,aY=e/aU/2,aZ=0.5,a8=aY/(2*aZ),a6=0.4*a8*aY/1000,aX=Math.abs(ba.x-a3.x),aW=Math.abs(ba.y-a3.y),a4=0,a1=0;if(aW==0){a4=aX}else{var aV=Math.abs(ba.x-a3.x)/Math.abs(ba.y-a3.y);a1=Math.round(Math.sqrt(a6*a6/(1+aV*aV)));a4=Math.round(aV*a1)}if(a7[0]==-1){a4=-a4}if(a7[1]==-1){a1=-a1}if(a0.dragAni){a0.dragAni.stop();a0.dragAni=null;bc.dispatchEvent(new aw("onmoveend"))}var aT=aY/1000,a5=bc.offsetX,a2=bc.offsetY,bb=false;a0.dragAni=new aG({duration:a8,fps:30,transition:function(bd){var bd=bd*aT/(2*aZ);return aT*bd-aZ*bd*bd},render:function(bd){bd=bd*(4*aZ)/(aT*aT);bb=!bb;bc._setPlatformPosition(a5+Math.round(bd*a4),a2+Math.round(bd*a1),null,bb)},finish:function(){a0.dragAni=null;bc._setPlatformPosition(a5+Math.round(a4),a2+Math.round(a1));bc.dispatchEvent(new aw("onmoveend"))}})}};BMap.register(function(i){var e=i;l.on(document,"keydown",function(aT){if(e.temp.stopArrow==true){e.temp.stopArrow=false}if(e.config.enableKeyboard&&e.temp.canKeyboard){var aT=window.event||aT;switch(aT.keyCode||aT.which){case 43:case 189:case 109:e.temp.operating=true;e.dispatchEvent(new aw("onminuspress"));break;case 43:case 61:case 187:case 107:e.temp.operating=true;e.dispatchEvent(new aw("onpluspress"));break;case 33:e.temp.operating=false;e.temp.stopArrow=true;e.panBy(0,Math.round(e.height*0.8));aT.cancelBubble=true;aT.returnValue=false;break;case 34:e.temp.operating=false;e.temp.stopArrow=true;e.panBy(0,-Math.round(e.height*0.8));aT.cancelBubble=true;aT.returnValue=false;break;case 35:e.temp.operating=false;e.temp.stopArrow=true;e.panBy(-Math.round(e.width*0.8),0);aT.cancelBubble=true;aT.returnValue=false;break;case 36:e.temp.operating=false;e.temp.stopArrow=true;e.panBy(Math.round(e.width*0.8),0);aT.cancelBubble=true;aT.returnValue=false;break;case 37:e.temp.operating=true;e.temp.arrow|=1;e._arrow();aT.cancelBubble=true;aT.returnValue=false;break;case 38:e.temp.operating=true;e.temp.arrow|=2;e._arrow();aT.cancelBubble=true;aT.returnValue=false;break;case 39:e.temp.operating=true;e.temp.arrow|=4;e._arrow();aT.cancelBubble=true;aT.returnValue=false;break;case 40:e.temp.operating=true;e.temp.arrow|=8;e._arrow();aT.cancelBubble=true;aT.returnValue=false;break}}});l.on(document,"keyup",function(aT){if(e.config.enableKeyboard){var aT=window.event||aT;switch(aT.keyCode||aT.which){case 37:e.temp.arrow=e.temp.arrow&~1;if(e.temp.arrow!=0){e._arrow()}break;case 38:e.temp.arrow=e.temp.arrow&~2;if(e.temp.arrow!=0){e._arrow()}break;case 39:e.temp.arrow=e.temp.arrow&~4;if(e.temp.arrow!=0){e._arrow()}break;case 40:e.temp.arrow=e.temp.arrow&~8;if(e.temp.arrow!=0){e._arrow()}break}}e.temp.operating=false});C.prototype._arrow=function(){if(this._arrow.occurrent&&this._arrow._lastArrow==this.temp.arrow&&this.temp.stopArrow==true){return}var aT=this;var aV=aT.temp.arrow;aT._arrow._lastArrow=aV;aT._arrow.interval=30;aT._arrow.duration=999;aT._arrow.dx=aT._arrow.dy=0;if(aV&1){aT._arrow.dx=1}if(aV&2){aT._arrow.dy=1}if(aV&4){aT._arrow.dx=-1}if(aV&8){aT._arrow.dy=-1}if(aV&1&&aV&4){aT._arrow.dx=0}if(aV&2&&aV&8){aT._arrow.dy=0}if(!aT._arrow.occurrent){aT._arrow.occurrent=true;aT._arrow.time=new Date().getTime();aT._arrow.beginTime=aT._arrow.time;aT.dispatchEvent(new aw("onmovestart"));var aU=new aG({fps:aT._arrow.interval,duration:aT._arrow.duration,transition:k.linear,render:function(a2){var aX=aT._arrow;var a0=aT.temp.arrow;if(aT._arrow._lastArrow!=a0){aT._arrow._lastArrow=a0;if(a0&1){aX.dx=1}if(a0&2){aX.dy=1}if(a0&4){aX.dx=-1}if(a0&8){aX.dy=-1}if(a0&1&&a0&4){aX.dx=0}if(a0&2&&a0&8){aX.dy=0}}if(aT.temp.stopArrow==true){aX.dx=0;aX.dy=0}var a1=new Date().getTime();var aZ=Math.pow((a1-aX.beginTime)/aX.duration,2);if(!aT.temp.arrow){aX.occurrent=false;aU.terminative=true;aT._arrow.time=new Date().getTime();setTimeout(function(){aT.dispatchEvent(new aw("onmoveend"))},40)}var a3=(a1-aX.time);var aY=aX.dx*a3*aZ>=0?Math.ceil(aX.dx*a3*aZ):Math.floor(aX.dx*a3*aZ);var aW=aX.dy*a3*aZ>=0?Math.ceil(aX.dy*a3*aZ):Math.floor(aX.dy*a3*aZ);if(aY!=0&&aW!=0){aY=Math.round(aY*0.7);aW=Math.round(aW*0.7)}aX.time=a1;aT._setPlatformPosition(aT.offsetX+aY,aT.offsetY+aW)},finish:function(){aT._arrow.time=new Date().getTime();setTimeout(function(){aT._arrowPan()},aT._arrow.interval)}})}};C.prototype._arrowPan=function(){var aW=this;var aU=aW._arrow;if(aW.temp.stopArrow){aU.dx=0;aU.dy=0}if(!aW.temp.arrow){aU.occurrent=false;aW.dispatchEvent(new aw("onmoveend"));return}var aX=new Date().getTime();var aY=(aX-aU.time);var aV=Math.ceil(aU.dx*aY);var aT=Math.ceil(aU.dy*aY);aU.time=aX;aW._setPlatformPosition(aW.offsetX+aV,aW.offsetY+aT);setTimeout(function(){aW._arrowPan()},aU.interval)}});aE.prototype.zoom=function(aV,aU){var aX=aU?aU.width:0;var aW=aU?aU.height:0;var a8=this.map;var ba=a8.config;var a9=this;if(!a9.tilesDiv){return}var a7={x:aV.x-parseInt(a9.tilesDiv.style.left)-a8.offsetX,y:aV.y-parseInt(a9.tilesDiv.style.top)-a8.offsetY};if(a8.overlayDiv){l.hide(a8.overlayDiv)}var e;for(var a4=0,a3=a9.tileLayers.length;a4<a3;a4++){e=a9.tileLayers[a4];if(!e.baseLayer){e.tilesDiv.style.visibility="hidden"}}if(!this.zoomsDiv){this.zoomsDiv=this.tilesDiv.cloneNode(true)}else{if(this.zoomsDiv.parentNode&&!this._zTimeLine){this.zoomsDiv.parentNode.removeChild(this.zoomsDiv);this.zoomsDiv=null;this.zoomsDiv=this.tilesDiv.cloneNode(true)}}var aT=this.zoomsDiv,a1=aT.style;a1.display="block";this.tilesDiv.style.visibility="hidden";a8.platform.insertBefore(aT,a8.platform.firstChild);var a6=[];var aY=a8.zoomLevel-a8.lastLevel;if(!a9._diff){a9._diff=aY}else{if(a8.zoomLevel-a8.lastLevel>0){a9._diff++}else{a9._diff--}}if(this._zTimeLine&&this._zTimeLine.schedule==0){this._zTimeLine.stop();this._zTimeLine=null;aY=a9._diff}if((!aU||aU.width==0&&aU.height==0)&&ba.enableContinuousZoom){a8.temp.zoomer.action(aV,aY>0?true:false)}var a0=Math.pow(2,aY);var a5=aT.children.length;for(var a4=a5-1;a4>-1;a4--){var aZ={};var a2=aT.children[a4].style;aZ.top=parseInt(a2.top)||0;aZ.left=parseInt(a2.left)||0;aZ.width=parseInt(a2.width);aZ.height=parseInt(a2.height);aZ.dw=aZ.width*a0-aZ.width;aZ.dh=aZ.height*a0-aZ.height;aZ.dx=(aZ.left-a7.x)*a0-(aZ.left-a7.x);aZ.dy=(aZ.top-a7.y)*a0-(aZ.top-a7.y);a6[a4]=aZ}aT._ol=parseInt(aT.style.left);aT._ot=parseInt(aT.style.top);if(this._zTimeLine){this._zTimeLine.stop();this._zTimeLine=null}this._zTimeLine=new aG({fps:20,duration:ba.enableContinuousZoom?ba.zoomerDuration:1,transition:k.easeInQuad,render:function(bd){if(bd<0.1){return}for(var bc=a6.length-1;bc>-1;bc--){var be=a6[bc];if(aT.children[bc]){var bb=aT.children[bc].style;bb.top=Math.round(be.top+be.dy*bd)+"px";bb.left=Math.round(be.left+be.dx*bd)+"px";bb.width=Math.ceil(be.width+be.dw*bd)+"px";bb.height=Math.ceil(be.height+be.dh*bd)+"px"}}if(aX||aW){a1.left=aT._ol-(aX*bd)+"px";a1.top=aT._ot-(aW*bd)+"px"}},finish:function(){a9.moveGridTiles(true);if(a8.overlayDiv){if(l.Browser.ie&&l.Browser.ie<8||document.compatMode=="BackCompat"){l.show(a8.overlayDiv)}else{setTimeout(function(){l.show(a8.overlayDiv)},100)}}for(var bc=0,bb=a9.tileLayers.length;bc<bb;bc++){e=a9.tileLayers[bc];if(!e.baseLayer){e.tilesDiv.style.visibility=""}}a9.tilesDiv.style.visibility="";delete a9._diff;a8.dispatchEvent(new aw("onzoomend"));aT=null;a9._zTimeLine=null}})};');
﻿_jsload&&_jsload('control', 'l.extend(K.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);this._render();this._updateState();this._bind(e);return this._container},_bind:function(i){var e=this;i.addEventListener("load",function(aT){e._updateState()});i.addEventListener("moveend",function(aT){e._updateState()});i.addEventListener("zoomend",function(aT){e._updateState()})},_render:function(){P.prototype._render.call(this);l.ac(this._container,"BMap_cpyCtrl");this._container.style.cursor="default";this._container.style.whiteSpace="nowrap";this._container.style.MozUserSelect="none";P.prototype._setPosition.call(this)},_updateState:function(){if(!this._map||!this._container||this._copyrightCollection.length==0){return}for(var aW=0,aU=this._copyrightCollection.length;aW<aU;aW++){var aT;var e=this._map.getZoom();if(this._copyrightCollection[aW].mapType!=""&&this._map.mapType!=this._copyrightCollection[aW].mapType){aT=false}else{if(e<this._copyrightCollection[aW].minZoom){aT=false}else{var a0=this._map.pixelToPoint({x:0,y:0});var aZ=this._map.pixelToPoint({x:this._map.width,y:this._map.height});var aY=new y(a0.lng,a0.lat,aZ.lng,aZ.lat);if(this._copyrightCollection[aW].bounds&&aY.intersects(this._copyrightCollection[aW].bounds)==null){aT=false}else{aT=true}}}if(aT){if(this._container){var a1=false;for(var aV=0,aX=this._container.children.length;aV<aX;aV++){if(this._container.children[aV].getAttribute("_cid")==this._copyrightCollection[aW].id){a1=true;this._container.children[aV].style.display="inline";if(this._container.children[aV].innerHTML!=this._copyrightCollection[aW].content){this._container.children[aV].innerHTML=this._copyrightCollection[aW].content}break}}if(!a1){this._generateHTML(this._copyrightCollection[aW])}}}else{if(this._container){for(var aV=0;aV<this._container.children.length;aV++){if(this._container.children[aV].getAttribute("_cid")==this._copyrightCollection[aW].id&&this._container.children[aV].style.display!="none"){this._container.children[aV].style.display="none";return}}}}}},addCopyright:function(aU){if(!aU||typeof aU.id!="number"||isNaN(aU.id)){return}var e={minZoom:0,bounds:null,content:"",mapType:""};for(var aT in aU){e[aT]=aU[aT]}if(this._map){var aX=e.minZoom;if(aX==-1||aX<aJ[this._map.mapType].zoomLevelMin||aX>aJ[this._map.mapType].zoomLevelMax){e.minZoom=aJ[this._map.mapType].zoomLevelMin}if(e.mapType!=""&&!aJ[e.mapType]){e.mapType=BMAP_NORMAL_MAP}}var aV=this.getCopyright(aU.id);if(aV){for(var aW in e){aV[aW]=e[aW]}}else{this._copyrightCollection.push(e)}this._updateState()},getCopyright:function(aU){for(var aT=0,e=this._copyrightCollection.length;aT<e;aT++){if(this._copyrightCollection[aT].id==aU){return this._copyrightCollection[aT]}}},getCopyrightCollection:function(){return this._copyrightCollection},removeCopyright:function(aW){var aU;for(var aT=0,e=this._copyrightCollection.length;aT<e;aT++){if(this._copyrightCollection[aT].id==aW){aU=this._copyrightCollection.splice(aT,1);aT--;e=this._copyrightCollection.length}}var aV=this.getDom(aW);if(aV&&aV.parentNode){aV.parentNode.removeChild(aV);aV=null}this._updateState();return aU},_generateHTML:function(e){if(!this._container){return}this._container.innerHTML+="<span style=\'-webkit-text-size-adjust:none;color:#000;background:none;line-height:15px;font:11px arial,simsun\' _cid=\'"+e.id+"\'>"+e.content+"</span>"},getDom:function(aV){var aU=P.prototype.getDom.call(this);if(typeof aV=="undefined"){return aU}else{if(aU){for(var aT=0,e=aU.children.length;aT<e;aT++){if(aU.children[aT].getAttribute("_cid")==aV){return aU.children[aT]}}}}}});l.extend(ah.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);this._initParam();this._render();this._bind();this._initOverviewMap();l.on(this._container,"click",ag);l.on(this._container,"dblclick",ag);l.on(this._container,"mousewheel",ag);l.on(this._container,"mouseup",function(i){i=window.event||i;if(i.button==2){ag(i)}});if(window.addEventListener){this._container.addEventListener("DOMMouseScroll",function(i){ag(i)},true)}return this._container},_initParam:function(){if(this._init){return}this._init=true;this._omCanvas;this._omMapContainer;this._omView;this._omViewMv;this._omBtn;this._borderWidth=1;this._btnWidth=15;this._btnHeight=15;this._quad=4;this._overviewMap=null;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._curOMZoomLevel=-1;this._wRatio=1;this._hRatio=1;this._temp={};this._currentOp="";this._overviewInitialized=false},_getCurOMZoomLevel:function(){if(!this._map){return}var e=this._map.getZoom();var i=e-this._opts.zoomInterval;if(i<this._minZoomLevel){return this._minZoomLevel}else{if(i>this._maxZoomLevel){return this._maxZoomLevel}else{return i}}return -1},_render:function(){P.prototype._render.call(this);var e=l.Browser.ie!=false?" BMap_ie"+l.Browser.ie:"";var i=this._container;i.innerHTML=this._generateHTML();l.ac(i,"BMap_omCtrl"+e);this._omCanvas=i.children[0].children[0];this._omMapContainer=this._omCanvas.children[0];this._omViewMv=this._omCanvas.children[1];this._omViewMvInn=this._omViewMv.children[0];this._omBtn=i.children[1];this.setSize(this._opts.size);this._omViewMv.style.cursor=aQ.defaultCursor},_generateHTML:function(){var e=[\'<div class="BMap_omOutFrame"><div class="BMap_omInnFrame">\',\'<div class="BMap_omMapContainer"></div>\',\'<div class="BMap_omViewMv"><div class="BMap_omViewInnFrame"><div></div></div></div>\',\'</div></div><div class="BMap_omBtn"></div>\'];return e.join("")},_bind:function(){var e=this;l.on(this._omBtn,"click",function(){e.changeView()});if(l.Browser.ie){l.on(this._omBtn,"dblclick",function(){e.changeView()})}l.on(this._omViewMv,"mousedown",function(i){if(e._omViewMv&&typeof e._omViewMv._drag!="undefined"&&e._omViewMv._drag=="true"){return}i=window.event||i;if(i.button==2){return}e._omViewMv._drag="true";var i=window.event||i;if(e._omViewMv.setCapture){e._omViewMv.setCapture()}e._bind.iniX=parseInt(an(e._omViewMv).left);e._bind.iniY=parseInt(an(e._omViewMv).top);e._bind.mx=i.pageX||i.clientX;e._bind.my=i.pageY||i.clientY;e._bind.i=0;e._bind.j=0;e._setViewMvCursor(aQ.draggingCursor);ag(i);return D(i)});l.on(document,"mousemove",function(aY){if(e._omViewMv&&e._omViewMv._drag=="true"){var aY=window.event||aY;var i=aY.pageX||aY.clientX;var aZ=aY.pageY||aY.clientY;e._bind.curX=e._bind.iniX+i-e._bind.mx;e._bind.curY=e._bind.iniY+aZ-e._bind.my;var aX=3;e._bind._moveX=0;e._bind._moveY=0;if(e._bind.curX<=0){e._bind._moveX=aX}if(e._bind.curY<=0){e._bind._moveY=aX}if(e._bind.curX+e._omViewMv.offsetWidth>=e._overviewMap.width){e._bind._moveX=-aX}if(e._bind.curY+e._omViewMv.offsetHeight>=e._overviewMap.height){e._bind._moveY=-aX}e._omViewMv.style.left=e._bind.curX+"px";e._omViewMv.style.top=e._bind.curY+"px";if((e._bind._moveX!=0||e._bind._moveY!=0)&&!e._bind.intervalId){e._bind._mapMoving=true;var aW=e._overviewMap.offsetX;var aU=e._overviewMap.offsetY;var aV=aW+e._bind._moveX;var aT=aU+e._bind._moveY;e._overviewMap._setPlatformPosition(aV,aT);e._bind.intervalId=setInterval(function(){var a1=e._bind._moveX!=0?(e._bind._moveX>0?e._bind.i+=aX:e._bind.i-=aX):e._bind.i;var a0=e._bind._moveY!=0?(e._bind._moveY>0?e._bind.j+=aX:e._bind.j-=aX):e._bind.j;e._overviewMap._setPlatformPosition(aV+a1,aT+a0)},30)}if(e._bind._moveX==0&&e._bind._moveY==0){clearInterval(e._bind.intervalId);delete e._bind.intervalId;e._bind.i=0;e._bind.j=0}ag(aY);return D(aY)}});l.on(document,"mouseup",function(aW){if(e._omViewMv&&e._omViewMv._drag=="true"){e._omViewMv._drag="";e._setViewMvCursor(aQ.defaultCursor);if(e._omViewMv.releaseCapture){e._omViewMv.releaseCapture()}if(e._bind.initX==e._bind.curX&&e._bind.initY==e._bind.curY){ag(aW);return D(aW)}e._currentOp="dragView";e._overviewMap.config.enableMouseDown=false;e._map.temp.operating=true;if(typeof e._bind.curX=="undefined"||typeof e._bind.curY=="undefined"){return}var aV=e._bind.curX+parseInt(e._omViewMv.style.width)/2+1;var aU=e._bind.curY+parseInt(e._omViewMv.style.height)/2+1;delete e._bind.curX;delete e._bind.curY;var aT=e._overviewMap.pixelToPoint({x:aV,y:aU},e._overviewMap.zoomLevel);var i=aJ[e._map.mapType].bounds;if(aT.lng<i[0]||aT.lng>i[2]||aT.lat<i[1]||aT.lat>i[3]){aT=e._overviewMap.getCenter()}e._map.temp.operating=false;if(e._bind._mapMoving==true){clearInterval(e._bind.intervalId);delete e._bind.intervalId;e._bind._mapMoving=false}e._map.temp.operating=true;setTimeout(function(){e._map.temp.operating=false;e._map.panTo(aT)},50);ag(aW);return D(aW)}})},_initOverviewMap:function(){if(this._overviewInitialized==true){return}var aT=this;var aU=aT._map;aU.addEventListener("resize",function(){if(aT._overviewMap!=null){aT._overviewMap.setCenter(aU.getCenter())}if(aT._omView!=null){aT._omView.setPoint(aU.getCenter());aT._setRatio()}aT.setAnchor(aT._opts.anchor)});if(this._opts.isOpen==false){return}if(!this._binded){aU.addEventListener("load",function(){aT._onMainZoomEnd()});aU.addEventListener("moving",function(){aT._moveView()});aU.addEventListener("moveend",function(aV){aT._onMainMoveEnd(aV)});aU.addEventListener("zoomend",function(aV){aT._onMainZoomEnd(aV)});aU.addEventListener("maptypechange",function(aV){aT._setRatio()});this._binded=true}var e=aU.getCenter();this._minZoomLevel=aJ[BMAP_NORMAL_MAP].zoomLevelMin;this._maxZoomLevel=aJ[BMAP_NORMAL_MAP].zoomLevelMax;this._curOMZoomLevel=this._getCurOMZoomLevel();this._overviewMap=new C(this._omMapContainer,{coordType:aU.config.coordType,isOverviewMap:true});this._overviewMap.disableDoubleClickZoom();this._overviewMap.centerAndZoom(e,this._curOMZoomLevel);this._omView=new aj({point:aU.getCenter(),lineStroke:1,lineColor:"#6688cc"});this._overviewMap.addOverlay(this._omView);this._omView.getDom().innerHTML=\'<div class="BMap_omViewInnFrame"><div class="BMap_omViewMask"></div></div>\';this._omViewInn=this._omView.getDom().children[0];var i=this._omView.getDom().style;i.borderLeftColor="#84b0df";i.borderTopColor="#adcff4";i.borderRightColor="#274b8b";i.borderBottomColor="#274b8b";this._setRatio();this._overviewMap.addEventListener("dragend",function(){aT._currentOp="dragMap";aU.panTo(aT._overviewMap.getCenter())});this._overviewMap.addEventListener("moveend",function(){aT._onViewMapMoveEnd()});this._overviewMap.addEventListener("mousedown",function(aV){aT._temp._downX=aV.offsetX;aT._temp._downY=aV.offsetY});this._overviewMap.addEventListener("resize",function(aV){if(aT._map&&aT._overviewMap){aT._overviewMap.setCenter(aT._map.getCenter())}aT._setRatio()});this._overviewInitialized=true},_setViewMvCursor:function(e){this._omViewMv.style.cursor=e},setAnchor:function(aV){P.prototype.setAnchor.call(this,aV);if(!this._map){return}if(l.Browser.ie){var aY=this._map.width;var aU=this._map.height;var i=this._opts.size.width;var aW=this._opts.size.height;var aT=this._opts.offset.width;var e=this._opts.offset.height;if(this._opts.isOpen==false){i=this._btnWidth;aW=this._btnHeight}var aX=this._container;switch(aV){case BMAP_ANCHOR_TOP_RIGHT:aX.style.right="auto";aX.style.left=aY-i-aT+"px";break;case BMAP_ANCHOR_BOTTOM_LEFT:aX.style.bottom="auto";aX.style.top=aU-aW-e+"px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:aX.style.bottom="auto";aX.style.right="auto";aX.style.top=aU-aW-e+"px";aX.style.left=aY-i-aT+"px";break;default:break}}this._setQuad();this._redraw()},changeView:function(){this.changeView._running=true;this._opts.isOpen=!this._opts.isOpen;if(!this._container){this.changeView._running=false;return}var aW=this._container;var e=this._opts.size.width;var aT=this._opts.size.height;var aV=this._btnWidth;var i=this._btnHeight;var aU=this;if(!this._opts.isOpen){this.changeView._preBtnTop=this._omBtn.style.top;this.changeView._preBtnLeft=this._omBtn.style.left;new aG({fps:25,duration:120,transition:k.easeInCubic,render:function(aX){aW.style.width=(e-Math.ceil((e-aV)*aX))+"px";aW.style.height=(aT-Math.ceil((aT-i)*aX))+"px";if(l.Browser.ie){aU._omBtn.style.top=(aU._quad==3||aU._quad==4)?parseInt(aW.style.height)-i+"px":"0";aU._omBtn.style.left=(aU._quad==1||aU._quad==4)?parseInt(aW.style.width)-aV+"px":"0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-parseInt(aW.style.height)-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-parseInt(aW.style.width)-aU._opts.offset.width+"px"}}}aU.dispatchEvent(new aw("onviewchanging"))},finish:function(){if(l.Browser.ie){aU._omBtn.style.left="0";aU._omBtn.style.top="0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-aU._btnHeight-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-aU._btnWidth-aU._opts.offset.width+"px"}}}aU._redraw();l.ac(aU._omBtn,"BMap_omBtnClosed");var aX=new aw("onviewchanged");aX.isOpen=aU._opts.isOpen;aU.dispatchEvent(aX);aU.changeView._running=false}})}else{if(this._overviewInitialized==false){this._initOverviewMap()}new aG({fps:40,duration:120,transition:k.easeOutCubic,render:function(aX){aW.style.width=(Math.ceil(e*aX))+"px";aW.style.height=(Math.ceil(aT*aX))+"px";if(l.Browser.ie){aU._omBtn.style.top=(aU._quad==3||aU._quad==4)?parseInt(aW.style.height)-i+"px":"0";aU._omBtn.style.left=(aU._quad==1||aU._quad==4)?parseInt(aW.style.width)-aV+"px":"0";if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-parseInt(aW.style.height)-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-parseInt(aW.style.width)-aU._opts.offset.width+"px"}}}aU.dispatchEvent(new aw("onviewchanging"))},finish:function(){if(aU._opts.anchor>=0&&aU._opts.anchor<=BMAP_ANCHOR_BOTTOM_RIGHT){if(l.Browser.ie){if(aU._quad==3||aU._quad==4){aW.style.top=aU._map.height-aT-aU._opts.offset.height+"px"}if(aU._quad==1||aU._quad==4){aW.style.left=aU._map.width-e-aU._opts.offset.width+"px"}}}aU._redraw();aU._setBtnPosition();l.rc(aU._omBtn,"BMap_omBtnClosed");var aX=new aw("onviewchanged");aX.isOpen=aU._opts.isOpen;aU.dispatchEvent(aX);aU.changeView._running=false}})}},_setRatio:function(){if(!this._map){return}var aX=this._map.zoomLevel;var aZ=this._map.pixelToPoint({x:0,y:0},aX);var aU=this._map.pixelToPoint({x:this._map.width,y:this._map.height},aX);var i=this._overviewMap.pixelToPoint({x:0,y:0},this._curOMZoomLevel);var aT=this._overviewMap.pixelToPoint({x:this._overviewMap.width,y:this._overviewMap.height},this._curOMZoomLevel);this._wRatio=(aU.lng-aZ.lng)/(aT.lng-i.lng);this._hRatio=(aU.lat-aZ.lat)/(aT.lat-i.lat);if(this._wRatio>=1||this._hRatio>=1){this._omViewMv.style.display="none";this._omView.hide()}else{var aV=parseInt(this._overviewMap.width);var e=parseInt(this._overviewMap.height);var aY=Math.round(aV*this._wRatio);var aW=Math.round(e*this._hRatio);if(this._map.mapType==BMAP_PERSPECTIVE_MAP){aW=e*0.35}this._omView.show();this._omView.setDimension(aY,aW);this._omViewMv.style.display=""}this._setOMViewMvPos()},_setOMViewMvPos:function(){if(!this._omView||!this._omView.getDom()){return}if(this._wRatio>=1||this._hRatio>=1){this._omViewMv.style.display="none";return}var i=this._omView.getDom().style;this._omViewMv.style.display="";this._omViewMv.style.width=i.width;this._omViewMv.style.height=i.height;var e=parseInt(i.width)-2;var aT=parseInt(i.height)-2;e=e<0?0:e;aT=aT<0?0:aT;this._omViewMvInn.style.width=e+"px";this._omViewMvInn.style.height=aT+"px";this._omViewInn.style.width=this._omViewMvInn.style.width;this._omViewInn.style.height=this._omViewMvInn.style.height;this._omViewMv.style.left=parseInt(i.left)+this._overviewMap.offsetX+"px";this._omViewMv.style.top=parseInt(i.top)+this._overviewMap.offsetY+"px"},setSize:function(aT){if(!aT||aT.toString()!="Size"){aT=new X(150,150)}var i=aT.width;var aU=aT.height;i=i>0?i:150;aU=aU>0?aU:150;aT.width=i;aT.height=aU;this._opts.size=aT;if(!this._container){return}if(this.changeView._running==true){var e=arguments;var aV=this;setTimeout(function(){e.callee.call(aV,aT)},120);return}aP(this._container,[i,aU]);var aV=this;setTimeout(function(){if(aV._overviewMap&&aV._map){aV._overviewMap.setCenter(aV._map.getCenter())}},100);this.setAnchor(this._opts.anchor);this.dispatchEvent(new aw("resize"))},getSize:function(){if(this._container){return new X(parseInt(this._container.style.width),parseInt(this._container.style.height))}else{return this._opts.size}},setOffset:function(e){if(!e||e.toString()!="Size"){return}P.prototype.setOffset.call(this,e);if(e.width!=0||e.height!=0){l.ac(this._container,"withOffset")}else{l.rc(this._container,"withOffset")}},_redraw:function(){if(!this._omCanvas){return}var aT=this._opts.size.width;var aW=this._opts.size.height;var aY=this._opts.padding;var e=this._borderWidth;var aU=0;var aX=0;var i=0;var aV=0;this._omCanvas.style.left=this._omCanvas.style.top=this._omCanvas.style.right=this._omCanvas.style.bottom="auto";this._omBtn.style.left=this._omBtn.style.top=this._omBtn.style.right=this._omBtn.style.bottom="auto";if(this._opts.offset.width==0&&this._opts.offset.height==0){switch(this._opts.anchor){case BMAP_ANCHOR_TOP_LEFT:this._omCanvas.style.left="0px";this._omCanvas.style.top="0px";break;case BMAP_ANCHOR_TOP_RIGHT:this._omCanvas.style.left=aY+"px";this._omCanvas.style.top="0px";break;case BMAP_ANCHOR_BOTTOM_LEFT:this._omCanvas.style.top=aY+"px";this._omCanvas.style.left="0px";break;case BMAP_ANCHOR_BOTTOM_RIGHT:this._omCanvas.style.top=aY+"px";this._omCanvas.style.left=aY+"px";break;default:break}aU=aT-e;aX=aW-e;i=aU-aY-2*e;aV=aX-aY-2*e;if(l.Browser.ie&&document.compatMode=="BackCompat"){aU=aU+1;aX=aX+1;i=i+2;aV=aV+2}}else{this._omCanvas.style.left=this._omCanvas.style.top=this._omCanvas.style.right=this._omCanvas.style.bottom=aY+"px";aU=aT-2*e;aX=aW-2*e;i=aU-2*aY-2*e;aV=aX-2*aY-2*e;if(this._opts.offset.width!=0||this._opts.offset.height!=0){l.ac(this._container,"withOffset")}if(l.Browser.ie&&document.compatMode=="BackCompat"){aU=aU+2;aX=aX+2;i=i+2;aV=aV+2}}if(aU>0&&aX>0){aP(this._container.children[0],[aU,aX])}if(i>0&&aV>0){aP(this._omCanvas,[i,aV])}this._setBtnPosition();l.rc(this._omBtn,"BMap_omBtnClosed");if(!this._opts.isOpen){this._container.style.width=this._btnWidth+"px";this._container.style.height=this._btnHeight+"px";if(l.Browser.ie){this.changeView._preBtnTop=this._omBtn.style.top;this.changeView._preBtnLeft=this._omBtn.style.left;this._omBtn.style.left="0";this._omBtn.style.top="0"}l.ac(this._omBtn,"BMap_omBtnClosed")}},_setQuad:function(){var i=this._container;if(!i){return}var e=this._quad;switch(this._opts.anchor){case BMAP_ANCHOR_TOP_LEFT:this._quad=2;break;case BMAP_ANCHOR_TOP_RIGHT:this._quad=1;break;case BMAP_ANCHOR_BOTTOM_LEFT:this._quad=3;break;case BMAP_ANCHOR_BOTTOM_RIGHT:this._quad=4;break;default:break}l.rc(i,"quad"+e);l.ac(i,"quad"+this._quad)},_setBtnPosition:function(){if(!l.Browser.ie){switch(this._quad){case 2:this._omBtn.style.top="0";this._omBtn.style.left="0";break;case 1:this._omBtn.style.top="0";this._omBtn.style.right="0";break;case 4:this._omBtn.style.bottom="0";this._omBtn.style.right="0";break;case 3:this._omBtn.style.bottom="0";this._omBtn.style.left="0";break;default:break}}else{var aU=this._btnWidth;var i=this._btnHeight;var e=this._opts.size.width;var aT=this._opts.size.height;this._omBtn.style.left="auto";this._omBtn.style.top="auto";this._omBtn.style.right="auto";this._omBtn.style.bottom="auto";switch(this._quad){case 2:this._omBtn.style.left="0px";this._omBtn.style.top="0px";break;case 1:this._omBtn.style.left=e-aU+"px";this._omBtn.style.top="0px";break;case 4:this._omBtn.style.top=aT-i+"px";this._omBtn.style.left=e-aU+"px";break;case 3:this._omBtn.style.left="0px";this._omBtn.style.top=aT-i+"px";break;default:break}}},_moveView:function(){if(this._omView){this._omView.setPoint(this._map.getCenter())}},_onMainMoveEnd:function(i){switch(this._currentOp){case"dragMap":this._setOMViewMvPos();this._currentOp="";break;case"dragView":this._omViewMv.style.display="none";this._overviewMap.panTo(this._map.getCenter(),false,90);this._currentOp="";break;default:if(this._overviewMap){this._overviewMap.panTo(this._map.getCenter(),false,90)}break}},_onMainZoomEnd:function(){if(!this._overviewMap){return}var e=this;e._curOMZoomLevel=e._getCurOMZoomLevel();setTimeout(function(){e._overviewMap.centerAndZoom(e._map.getCenter(),e._curOMZoomLevel);e._omView.setPoint(e._map.getCenter());e._setRatio()},100)},_onViewMapMoveEnd:function(){if(this._currentOp!="dragMap"){this._setOMViewMvPos();this._overviewMap.config.enableMouseDown=true}},remove:function(){P.prototype.remove.call(this);this._omCanvas=null;this._omMapContainer=null;this._omView=null;this._omViewInn=null;this._omViewMv=null;this._omViewMvInn=null;this._omBtn=null;this._overviewInitialized=false;this._overviewMap=null},isOpen:function(){if(!this._container){return false}return this._opts.isOpen}});l.extend(H.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map);this.dispatchEvent(new aw("ondomready"))}},initialize:function(e){P.prototype.initialize.call(this,e);this._initParam();this._setParam();this._render();this._bind();this._setSliderZoomLv(e.getZoom());this._bindMapEvent(e);return this._container},_initParam:function(){if(this._init){return}this._init=true;this._maxTotalZoomLv=18;this._minZoomLevel=-1;this._maxZoomLevel=-1;this._totalZoomLv=-1;this._sliderInterval=7;this._minBarY=1;this._maxBarY=-1;this._curBarY=-1;this._zoomDom=null;this._zoomBtnDom=null;this._sliderDom=null;this._sliderBaseDom=null;this._cZIndex="1100"},_bindMapEvent:function(i){var e=this;i.addEventListener("zoomend",function(aT){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom());if(e._msover){return}if(e._isShowLevelHint){e._hideTimerId=setTimeout(function(){e._hideLevelHint()},1000)}});i.addEventListener("mousewheel",function(){if(!e._map){return}if(e._map.config.enableWheelZoom&&e._isShowLevelHint){if(e._hideTimerId){clearTimeout(e._hideTimerId);e._hideTimerId=null}e._showLevelHint()}});i.addEventListener("load",function(aT){if(!e._map){return}e._setSliderZoomLv(e._map.getZoom())});i.addEventListener("maptypechange",function(aT){if(!e._map){return}e.redraw()})},redraw:function(){this._setParam();this.setType(this._opts.type);if(this._map){this._setSliderZoomLv(this._map.getZoom())}},_setParam:function(){this._minZoomLevel=this._map.config.zoomLevelMin;this._maxZoomLevel=this._map.config.zoomLevelMax;if(this._minZoomLevel!=aJ[BMAP_NORMAL_MAP].zoomLevelMin||this._maxZoomLevel!=aJ[BMAP_NORMAL_MAP].zoomLevelMax){this._isShowLevelHint=false}else{this._isShowLevelHint=true}if(!this._opts.showZoomInfo){this._isShowLevelHint=false}this._totalZoomLv=this._maxZoomLevel-this._minZoomLevel+1;this._maxBarY=this._minBarY+(this._totalZoomLv-1)*this._sliderInterval},_render:function(){P.prototype._render.call(this);var aT=l.Browser.ie==6?" BMap_ie6":"";var i=" BMap_stdMpType"+this._opts.type;var aU=this._container;l.ac(aU,"BMap_stdMpCtrl");l.ac(aU,aT);l.ac(aU,i);aU.innerHTML=this._generateHtml(this._opts.type);this._setSliderBarCursor(l.Browser.opera?"pointer":aQ.defaultCursor);this._zoomDom=l.G(aU.children[1]);var e=this._zoomDom;this._zoomBtnDom=l.G(e.children[0]);this._sliderDom=l.G(e.children[1]);this._sliderBaseDom=l.G(e.children[1].children[0]);this._sliderBotDom=l.G(e.children[1].children[1]);this.setType(this._opts.type)},_setSliderHeight:function(){var a0=this._opts.type;var e=this._getControlHeight(a0);var aY=e.width;var i=e.height;var aV=e.zoomHeight;var aZ=e.zoomWidth;var aT=e.sliderHeight;var aW=e.sliderCHeight;var aU=(this._maxTotalZoomLv-this._totalZoomLv)*this._sliderInterval;if(this._opts.type==BMAP_NAVIGATION_CONTROL_LARGE){i=i-aU>=0?i-aU:0;aV=aV-aU>=0?aV-aU:0;aT=aT-aU>=0?aT-aU:0;aW=aW-aU>=0?aW-aU:0;sliderBotDomTop=124-aU>=0?124-aU:0;this._sliderBotDom.style.top=sliderBotDomTop+"px"}this._container.style.width=aY+"px";this._container.style.height=i+"px";this._zoomDom.style.height=aV+"px";this._zoomDom.style.width=aY+"px";this._zoomBtnDom.style.height=aV+"px";this._zoomBtnDom.style.width=aZ+"px";this._sliderDom.style.height=aT+"px";this._sliderBaseDom.style.height=aW+"px";var aX=this._zoomBtnDom.children;if(this._opts.type==BMAP_NAVIGATION_CONTROL_ZOOM){aX[0].style.left=aX[1].style.left="0"}else{aX[0].style.left=aX[1].style.left=""}},_getControlHeight:function(e){var i=[{width:this._opts.showZoomInfo?52:37,height:226,zoomHeight:167,zoomWidth:37,sliderHeight:133,sliderCHeight:124},{width:37,height:97,zoomHeight:38,zoomWidth:37,sliderHeight:0,sliderCHeight:0},{width:37,height:57,zoomHeight:0,zoomWidth:0,sliderHeight:0,sliderCHeight:0},{width:18,height:38,zoomHeight:38,zoomWidth:18,sliderHeight:0,sliderCHeight:0}];return i[e]},_generateHtml:function(){var e=[];e.push(this._generatePanHtml());e.push(this._generateZoomContainerHtml());return e.join("")},_generatePanHtml:function(){var e=\'<div class="BMap_stdMpPan"><div class="BMap_button BMap_panN" title="\u5411\u4e0a\u5e73\u79fb"></div><div class="BMap_button BMap_panW" title="\u5411\u5de6\u5e73\u79fb"></div><div class="BMap_button BMap_panE" title="\u5411\u53f3\u5e73\u79fb"></div><div class="BMap_button BMap_panS" title="\u5411\u4e0b\u5e73\u79fb"></div><div class="BMap_stdMpPanBg BMap_smcbg"></div></div>\';return e},_generateZoomContainerHtml:function(){var e=\'<div class="BMap_stdMpZoom">\'+this._generateZoomHtml()+this._generateSliderHtml()+this._generateZoomBalloonHtml()+"</div>";return e},_generateZoomHtml:function(){var e=\'<div><div class="BMap_button BMap_stdMpZoomIn" title="\u653e\u5927\u4e00\u7ea7"><div class="BMap_smcbg"></div></div><div class="BMap_button BMap_stdMpZoomOut" title="\u7f29\u5c0f\u4e00\u7ea7"><div class="BMap_smcbg"></div></div></div>\';return e},_generateSliderHtml:function(){var e=\'<div class="BMap_stdMpSlider"><div class="BMap_stdMpSliderBgTop"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderBgBot"><div class="BMap_smcbg"></div></div><div class="BMap_stdMpSliderMask" title="\u653e\u7f6e\u5230\u6b64\u7ea7\u522b"></div><div class="BMap_stdMpSliderBar" title="\u62d6\u52a8\u7f29\u653e"><div class="BMap_smcbg"></div></div></div>\';return e},_generateZoomBalloonHtml:function(){var e=\'<div class="BMap_zlHolder"><div class="BMap_zlSt"><div class="BMap_smcbg"></div></div><div class="BMap_zlCity"><div class="BMap_smcbg"></div></div><div class="BMap_zlProv"><div class="BMap_smcbg"></div></div><div class="BMap_zlCountry"><div class="BMap_smcbg"></div></div></div>\';return e},setType:function(e){if(typeof e=="number"&&e>=BMAP_NAVIGATION_CONTROL_LARGE&&e<=BMAP_NAVIGATION_CONTROL_ZOOM){this._opts.type=e}else{this._opts.type=BMAP_NAVIGATION_CONTROL_LARGE}if(!this._map||!this._container){return}var i=this._container;i.className=i.className.replace(/BMap_stdMpType\\d/,"BMap_stdMpType"+this._opts.type);this._setSliderHeight();if(e!=BMAP_NAVIGATION_CONTROL_LARGE){l.rc(i.children[1].children[2],"hvr")}this.setAnchor(this._opts.anchor)},getType:function(){return this._opts.type},_bind:function(){var aZ=this;var aY=aZ._container;l.on(this._zoomDom,"mouseover",function(){if(!aZ._isShowLevelHint){return}aZ._msover=true;if(aZ._hideTimerId){clearTimeout(aZ._hideTimerId);aZ._hideTimerId=null}aZ._showLevelHint()});l.on(this._zoomDom,"mouseout",function(){if(!aZ._isShowLevelHint){return}if(aZ._hideTimerId){clearTimeout(aZ._hideTimerId)}aZ._msover=false;aZ._hideTimerId=setTimeout(function(){aZ._hideLevelHint();aZ._hideTimerId=null},1000)});l.on(aY.children[0],"mouseover",function(){aZ._hideLevelHint(true)});l.on(aY.children[0].children[0],"click",function(){aZ._panBy(0,Math.round(aZ._map.height/3))});l.on(aY.children[0].children[1],"click",function(){aZ._panBy(Math.round(aZ._map.width/3),0)});l.on(aY.children[0].children[2],"click",function(){aZ._panBy(-Math.round(aZ._map.width/3),0)});l.on(aY.children[0].children[3],"click",function(){aZ._panBy(0,-Math.round(aZ._map.height/3))});var aW=aY.children[1].children[0].children;l.on(aW[0],"click",function(){aZ._zoomIn()});l.on(aW[1],"click",function(){aZ._zoomOut()});for(var aU=1;aU<6;aU++){l.on(aY.children[0].children[aU],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aY.children[0].children[aU],"contextmenu",function(i){D(i)});l.on(aY.children[0].children[aU],"click",function(i){D(i)})}l.on(aW[0],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[1],"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[0],"contextmenu",function(i){D(i)});l.on(aW[1],"contextmenu",function(i){D(i)});var a0=aY.children[1].children[1].children[2];l.on(a0,"mouseup",function(i){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0&&(aZ._map.currentOperation&aL.drag)==0){ag(i)}});l.on(aW[0],"click",function(i){ag(i)});l.on(aW[1],"click",function(i){ag(i)});l.on(a0,"click",function(i){ag(i)});var aX=aY.children[1].children[1].children[3];l.on(aX,"mouseup",function(i){if(i.button==2){ag(i)}});l.on(aX,"contextmenu",function(i){D(i)});l.on(this._zoomDom.children[2].children[0],"click",function(i){aZ._map.zoomTo(18)});l.on(this._zoomDom.children[2].children[1],"click",function(i){aZ._map.zoomTo(12)});l.on(this._zoomDom.children[2].children[2],"click",function(i){aZ._map.zoomTo(8)});l.on(this._zoomDom.children[2].children[3],"click",function(i){aZ._map.zoomTo(4)});l.on(a0,"mousedown",function(a1){a1=window.event||a1;var i=0;if(typeof a1.layerY!="undefined"){i=a1.layerY}else{if(typeof a1.offsetY!="undefined"){i=a1.offsetY}}var a2=0;a2=(aZ._maxZoomLevel+1)-Math.round(aZ._totalZoomLv*parseFloat(i/(aZ._totalZoomLv*aZ._sliderInterval)));aZ._map.zoomTo(a2)});l.on(aX,"mouseover",function(){l.ac(aX,"h")});l.on(aX,"mouseout",function(){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)==0){l.rc(aX,"h")}});var aV=function(i){var i=window.event||i;if(i.button==2){return}if((l.Browser.ie&&i.button!=1)){return}if(aX.setCapture){aX.setCapture()}aZ._map.currentOperation|=aL.stdMapCtrlDrag;aZ._bind.my=i.pageY||i.clientY||0;if(!l.Browser.opera){aZ._setSliderBarCursor(aQ.draggingCursor)}l.on(document,"mousemove",e);l.on(document,"mouseup",aT);ag(i);return D(i)};var e=function(a1){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)!=0){var a1=window.event||a1;var a2=a1.pageY||a1.clientY;var i=aZ._curBarY+a2-aZ._bind.my;if(i<aZ._minBarY){aX.style.top=aZ._minBarY+"px"}else{if(i>aZ._maxBarY){aX.style.top=aZ._maxBarY+"px"}else{aX.style.top=i+"px"}}}};var aT=function(a1){if((aZ._map.currentOperation&aL.stdMapCtrlDrag)!=0){var i=l.G(aX);aZ._curBarY=parseInt(i.style.top);l.rc(aX,"h");aZ._map.currentOperation&=~aL.stdMapCtrlDrag;if(aY&&aX&&aX.releaseCapture){aX.releaseCapture()}if(!l.Browser.opera){aZ._setSliderBarCursor(aQ.defaultCursor)}var a2=(aZ._maxZoomLevel+1)-Math.round(parseFloat(aZ._curBarY-aZ._minBarY)/parseFloat(aZ._maxBarY-aZ._minBarY)*(aZ._totalZoomLv-1)+1);aZ._map.zoomTo(a2);l.un(document,"mousemove",e);l.un(document,"mouseup",aT)}};l.on(aX,"mousedown",aV)},_setSliderBarCursor:function(e){this._container.children[1].children[1].children[3].style.cursor=e},_panBy:function(i,e){this._map.panBy(i,e)},_zoomIn:function(){this._map.zoomIn()},_zoomOut:function(){this._map.zoomOut()},_setSliderZoomLv:function(i){if(!this._container||this.getType()!=BMAP_NAVIGATION_CONTROL_LARGE){return}var e=(this._maxZoomLevel-i)*this._sliderInterval+this._minBarY;this._curBarY=e>this._maxBarY?this._maxBarY:e<this._minBarY?this._minBarY:e;this._container.children[1].children[1].children[3].style.top=this._curBarY+"px"},_hideLevelHint:function(e){if(this._opts.type==0){l.rc(this._container.children[1].children[2],"hvr")}if(e&&this._hideTimerId){clearTimeout(this._hideTimerId);this._hideTimerId=null}},_showLevelHint:function(){if(this._opts.type==0&&this._opts.showZoomInfo){l.ac(this._container.children[1].children[2],"hvr")}},show:function(){P.prototype.show.call(this);if(l.Browser.ie<8){var e=this;setTimeout(function(){e.setType(e._opts.type)},1)}}});l.extend(T.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(e){P.prototype.initialize.call(this,e);if(!this._init){this._scaleText=null;this._numberArray={};this._init=true}this._render();this._setParam();this._updateScale();this._bind(e);return this._container},_setParam:function(){this._numberArray={us:[5280*5000,5280*2500,5280*2000,5280*1000,5280*500,5280*200,5280*100,5280*50,5280*25,5280*20,5280*10,5280*5,5280*2,5280,2000,1000,500,200,100,50,20,10,5],metric:[10000000,5000000,2000000,1000000,500000,200000,100000,50000,25000,20000,10000,5000,2000,1000,500,200,100,50,20,10,5,2,1]}},_bind:function(i){var e=this;i.addEventListener("zoomend",function(aT){e._updateScale()});i.addEventListener("load",function(aT){e._updateScale()});i.addEventListener("moveend",function(aT){e._updateScale()})},_render:function(){P.prototype._render.call(this);l.ac(this._container,"BMap_scaleCtrl");this._container.innerHTML=this._generateHTML();this._scaleText=this._container.children[0];P.prototype._setPosition.call(this)},_generateHTML:function(){var e=\'<div class="BMap_scaleTxt" unselectable="on"></div><div class="BMap_scaleBar BMap_scaleHBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div><div class="BMap_scaleBar BMap_scaleLBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div><div class="BMap_scaleBar BMap_scaleRBar"><img style="border:none" src="\'+aQ.imgPath+\'mapctrls11.png" /></div>\';return e},setUnit:function(e){this._opts.unit=this._units[e]&&this._units[e].name||this._opts.unit;if(!this._map){return}this._updateScale()},_setScaleText:function(i,e){if(typeof i!="number"||typeof e!="string"){return}this._scaleText.innerHTML=i+"&nbsp;"+e},_updateScale:function(){if(!this._map||!this._container){return}var aW=this._map.config.coordType;var i=aW==BMAP_COORD_LNGLAT?10:500000;var aV=new f(this._map.getCenter().lng,this._map.getCenter().lat+i);var aX=Math.abs(this._map.pointToPixel(this._map.getCenter()).y-this._map.pointToPixel(aV).y);var a1;if(aW==BMAP_COORD_LNGLAT){a1=V.getDistanceByLL(this._map.getCenter(),aV)/aX}else{if(aW==BMAP_COORD_MERCATOR){a1=V.getDistanceByMC(this._map.getCenter(),aV)/aX}}if(a1==0||isNaN(a1)){return}var aZ=this._convertUnit(a1,this._opts.unit);var e=0;var aT=this._units[this._opts.unit].incon;var aY=this._map.getZoom();var aU=this._numberArray[this._opts.unit][this._map.getZoom()-1];e=aU/aZ;var a0=aU>=aT?this._units[this._opts.unit].u2:this._units[this._opts.unit].u1;if(aU>=aT){aU=Math.round(aU/aT)}this._setScaleText(aU,a0);if(Math.round(e)%2!=0&&l.Browser.ie==6){e=e+1}this._container.style.width=Math.round(e)+"px";if(this._map.mapType==BMAP_PERSPECTIVE_MAP){this._container.style.width=Math.round(e)*3+"px";this._setScaleText(aU*3,a0)}},_convertUnit:function(e,i){i=i||"metric";if(this._units[i]){return e*this._units[i].conv}return e}});l.extend(ae.prototype,{_asyncDraw:function(){if(this._map){this._i(this._map)}},initialize:function(aT){P.prototype.initialize.call(this,aT);P.prototype._render.call(this);P.prototype._setPosition.call(this);this.mapTypeSpans={};l.extend(this._container.style,{cursor:"pointer",height:"22px",top:"10px",width:"82px",zIndex:"800"});var i=t("span");l.extend(i.style,{background:"transparent url("+aQ.imgPath+"mapctrls.gif) no-repeat 0 -152px",cursor:"pointer",height:"22px",width:"41px",zIndex:"800",display:"inline-block"});i.title="\u663e\u793a\u666e\u901a\u5730\u56fe";this._container.appendChild(i);this.mapTypeSpans.B_NORMAL_MAP=i;i=t("span");l.extend(i.style,{background:"transparent url("+aQ.imgPath+"mapctrls.gif) no-repeat -41px -152px",cursor:"pointer",height:"22px",width:"41px",zIndex:"800",display:"inline-block"});i.title="\u663e\u793a\u4e09\u7ef4\u5730\u56fe";this._container.appendChild(i);this.mapTypeSpans.B_DIMENSIONAL_MAP=i;i=null;this._bind(aT);var e=this;e.select(this._map.mapType);return this._container},_bind:function(aT){var i=this;var aU=this.mapTypeSpans.B_NORMAL_MAP;var e=this.mapTypeSpans.B_DIMENSIONAL_MAP;aU.onmousedown=function(){this.style.backgroundPosition="0 -130px";e.style.backgroundPosition="-41px -130px"};aU.onclick=function(){i._toggle("B_NORMAL_MAP")};e.onmousedown=function(){this.style.backgroundPosition="-41px -152px";aU.style.backgroundPosition="0 -152px"};e.onclick=function(){i._toggle("B_DIMENSIONAL_MAP")};aT.addEventListener("onmaptypechange",function(aV){i.select(aT.mapType)})},_toggle:function(aU){if(this._map.mapType==aU){return}var i=0;if(this._map.currentCity!=""){i=1}var aV=new aw("onbeforesetmaptype");aV.flag=i;aV.mapType=aU;this._map.dispatchEvent(aV);var aT=this;if(aT._opts.enableSwitch){if(i||aU=="B_NORMAL_MAP"){aT.select(aU)}return}},select:function(e){if(e=="B_NORMAL_MAP"){this.mapTypeSpans.B_NORMAL_MAP.style.backgroundPosition="0 -130px";this.mapTypeSpans.B_DIMENSIONAL_MAP.style.backgroundPosition="-41px -130px"}if(e=="B_DIMENSIONAL_MAP"){this.mapTypeSpans.B_DIMENSIONAL_MAP.style.backgroundPosition="-41px -152px";this.mapTypeSpans.B_NORMAL_MAP.style.backgroundPosition="0 -152px"}this._map.setMapType(e)},remove:function(){this.mapTypeSpans.B_DIMENSIONAL_MAP=this.mapTypeSpans.B_NORMAL_MAP=null;P.prototype.remove.call(this)}});');
﻿_jsload&&_jsload('marker', 'l.extend(aF.prototype,{initialize:function(e){this.map=e;this._addDom();this._bind();this.domElement.hashCode=this.hashCode;l.BaseClass.call(this,this.hashCode);if(!this._visible){l.hide(this.domElement)}this.dispatchEvent(new aw("ondomready"));return this.domElement},_bind:function(){if(!this.domElement){return}var e=this;var aT=this.map;function i(aX,aW){var aV=aX.srcElement||aX.target;var aU=aX.clientX||aX.pageX;var aZ=aX.clientY||aX.pageY;if(aX&&aW&&aU&&aZ&&aV){var aY=l.Dom.getOffset(aT.container);aW.pixel=new aK(aU-aY.left,aZ-aY.top);aW.point=aT.pixelToPoint(aW.pixel);return aW}else{return aW}}l.on(this.domElement,"mouseover",function(aU){if(!e._dragstarted){e.dispatchEvent(i(aU,new aw("onmouseover").inherit(aU)))}});l.on(this.domElement,"mouseout",function(aU){if(!e._dragstarted){e.dispatchEvent(i(aU,new aw("onmouseout").inherit(aU)))}});if(e._config.clickable){l.on(this.domElement,"touchstart",function(aU){e._bind._touchStartPos=new aK(aU.changedTouches[0].clientX,aU.changedTouches[0].clientY)});l.on(this.domElement,"touchend",function(aW){var aV=new Date().getTime(),aU=new aK(aW.changedTouches[0].clientX,aW.changedTouches[0].clientY);if(Math.abs(aU.x-e._bind._touchStartPos.x)>10||Math.abs(aU.y-e._bind._touchStartPos.y)>10){e._bind._touchStartPos=null;return}e.dispatchEvent(i(aW,new aw("onclick").inherit(aW)));if(aV-e._dblclickTime<e.map.config.clickInterval){e.dispatchEvent(i(aW,new aw("ondblclick").inherit(aW)))}e._dblclickTime=aV});l.on(this.domElement,"click",function(aV){var aU=aV.srcElement||aV.target;while(aU){if(aU==e.domElement){if(e.toString()!="Marker"||e.toString()=="Marker"&&(!e._lastPt||e._lastPt&&e.getPoint().equals(e._lastPt))){e.dispatchEvent(i(aV,new aw("onclick").inherit(aV)))}break}else{if(e.map.infoWindowDoms&&aU==e.map.infoWindowDoms.popDom){break}}aU=aU.parentNode}});l.on(this.domElement,"dblclick",function(aU){e.dispatchEvent(i(aU,new aw("ondblclick").inherit(aU)));aC(aU)})}l.on(this.domElement,"mousedown",function(aU){if(e.toString()=="Marker"){e._lastPt=e.getPoint()}e.dispatchEvent(i(aU,new aw("onmousedown").inherit(aU)))});l.on(this.domElement,"mouseup",function(aU){e.dispatchEvent(i(aU,new aw("onmouseup").inherit(aU)))});l.on(this.domElement,"contextmenu",function(aU){e.dispatchEvent(i(aU,new aw("onrightclick").inherit(aU)))})},hide:function(){if(this._visible==false){return}this._visible=false;O.prototype.hide.call(this);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay==this){this.closeInfoWindow()}},show:function(){if(this._visible==true){return}this._visible=true;O.prototype.show.call(this)},setStyle:function(e){if(this.domElement){if(this.siblingElement){this.siblingElement.style.cssText=this.siblingElement.style.cssText+";"+e}else{this.domElement.style.cssText=this.domElement.style.cssText+";"+e}}},setConfig:function(i){if(!i){return}for(var e in i){if(typeof(this._config[e])==typeof(i[e])){this._config[e]=i[e]}}},getPoint:function(aT,aU){if(!aT){return this.point}else{var e=aU?aU.width:0;var aV=aU?aU.height:0;if(this.map){var i=this.map.pointToPixel(this.point);if(this._config&&this._config.offset){i.x=i.x+this._config.offset.width+e;i.y=i.y+this._config.offset.height+aV}else{i.x=i.x+e;i.y=i.y+aV}return this.map.pixelToPoint(i)}}},setZIndex:function(e){var i=this;i.zIndex=e;i._updateDomZIndex()},_updateDomZIndex:function(){var i=this,e;if(typeof i.zIndex!="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){var aT=i.getPoint()?i.getPoint().lat:0;e=O.getZIndex(aT,i.map.config.coordType)+(i._config.baseZIndex||0)}}if(i.domElement){i.domElement.style.zIndex=e}},isVisible:function(){if(!this.domElement){return false}return !!this._visible}});J.TOP_ZINDEX=O.getZIndex(-90)+1000000;J.DRAG_ZINDEX=J.TOP_ZINDEX+1000000;l.extend(J.prototype,{initialize:function(e){aF.prototype.initialize.call(this,e);if(!this._visible){l.hide(this.siblingElement)}this.setPoint(this.point);this.setIcon(this._config.icon);if(this._config.label&&this._cfgLabelEvent){this._config.label.addEventListener("remove",this._cfgLabelEvent)}this.setLabel(this._config.label);this.setTitle(this._config.title);this._initDrag();return this.domElement},_addDom:function(){var e=this.map;this.domElement=Z(e.getPanes().markerMouseTarget,this._msTargetRender());this.siblingElement=Z(e.getPanes().markerPane,this._markerRender());this.siblingElement.hashCode=this.getHashCode()},_msTargetRender:function(){var e=[\'<span class="BMap_Marker BMap_noprint" unselectable="on" \'];e.push(this._config.title?\'title="\'+this._config.title+\'"\':\'"\');e.push(\' style="position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;\');e.push(this._config.clickable?"cursor:pointer;":"");e.push("background:url("+aQ.imgPath+"blank.gif);");e.push("width:"+this._config.icon.size.width+"px;");e.push("height:"+this._config.icon.size.height+"px;");e.push(\'"></span>\');return e.join("")},_markerRender:function(){var e=[\'<span class="BMap_Marker" unselectable="on" \'];e.push(\'style="position:absolute;padding:0;margin:0;border:0;\');e.push(\'width:0;height:0;-moz-user-select:none"></span>\');return e.join("")},draw:function(){if(this.domElement){var aT=this._config.offset||new X(0,0);var i=this._config.icon.offset||new X(0,0);var e=this.map.pointToOverlayPixel(this.getPoint());this.domElement.style.left=(e.x+aT.width-i.width)+"px";this.domElement.style.top=(e.y+aT.height-i.height)+"px";if(this.siblingElement){this.siblingElement.style.left=(e.x+aT.width)+"px";this.siblingElement.style.top=(e.y+aT.height)+"px"}if(this.infoWindow!=null&&this.infoWindow.isOpen()){this.infoWindow.setPosition()}this._updateDomZIndex()}},_draw:function(){if(this.map){this.domElement=this.initialize(this.map)}},remove:function(){if(this.siblingElement&&this.siblingElement.parentNode){this.siblingElement.parentNode.removeChild(this.siblingElement)}if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay===this){this.closeInfoWindow();this.infoWindow=null}this.siblingElement=null;this.iconDom=null;if(this._config.label){this._config.label.removeEventListener("remove",this._cfgLabelEvent);this._config.label.decontrol();this._config.label.setMarker(null);this._config.label.domElement=null;this._config.label=null}aF.prototype.remove.call(this)},hide:function(){aF.prototype.hide.call(this);if(this.infoWindow&&this.infoWindow.overlay&&this.infoWindow.overlay==this){this.closeInfoWindow()}l.hide(this.domElement);l.hide(this.siblingElement)},show:function(){aF.prototype.show.call(this);l.show(this.domElement);l.show(this.siblingElement)},setIcon:function(aU){if(!aU||aU.toString()!="Icon"){return}this._config.icon=aU;if(!this.map||!this.domElement||!this.siblingElement){return}var aW=this.map;try{if(this.iconDom){this.siblingElement.removeChild(this.iconDom);this.iconDom=null}this.domElement.style.width=aU.size.width+"px";this.domElement.style.height=aU.size.height+"px"}catch(aV){}if(this._config.icon){var i=this.iconDom=t("div",{"class":this.iconClassName});var aT=i.style;aT.position="absolute";aT.padding=aT.margin="0";aT.width=aU.size.width+"px";aT.height=aU.size.height+"px";aT.left=-aU.offset.width+"px";aT.top=-aU.offset.height+"px";aT.overflow="hidden";i.innerHTML=aU.getHTML();i.galleryImg=false;this.siblingElement.appendChild(this.iconDom)}this.draw()},setIconClassName:function(e){if(this.iconDom){this.iconDom.className=e}},getIcon:function(){return this._config.icon},setLabel:function(e){if(!e||e.toString()!="Label"){return}this._config.label=e;var aT=this;if(!this._config.label._binded){this._config.label._binded=true;this._cfgLabelEvent=function(){aT._config.label=null};this._config.label.addEventListener("remove",this._cfgLabelEvent)}if(!this.map){return}e._i(this.map);if(e.domElement){this.siblingElement.appendChild(e.domElement)}else{e.domElement=Z(this.domElement,e.render());e.domElement.hashCode=e.getHashCode()}var i=e.domElement.style;i.left=(e._config.offset.width)+"px";i.top=(e._config.offset.height)+"px";e.setMarker(this)},getLabel:function(){return this._config.label},_initDrag:function(){if(!this.domElement||this.domElement._binded){return}this.domElement._binded=true;var aX=this.map,aU=this,e=0,aY=0,aT=0,aW={x:0,y:0};function aV(a0,aZ){aZ.pixel=a0.pixel;aZ.point=a0.point;return aZ}function i(a1){var a0=a1.clientX,aZ=a1.clientY;if(a1.changedTouches){a0=a1.changedTouches[0].clientX;aZ=a1.changedTouches[0].clientY}return new aK(a0,aZ)}this.dragStart=function(a1){if(!aU._config.enableDragging){return}aU._isDragging=true;var a0=aX.pointToPixel(aU.point);var aZ=i(a1);e=aZ.x-a0.x;aY=aZ.y-a0.y;aT=new Date().getTime();aU.map.temp._draggingMarker=aU;l.on(document,"mousemove",aU.dragIng);l.on(document,"mouseup",aU.dragEnd);l.on(document,"touchmove",aU.dragIng);l.on(document,"touchend",aU.dragEnd);if(aU.domElement&&aU.domElement.setCapture){aU.domElement.setCapture()}};this.dragIng=function(a3){if(!aU._isDragging){return}var a0=i(a3);var a1=new aK((a0.x-e),(a0.y-aY));aW=a1;if((aU._config.restrictDraggingArea&&(a1.x>15&&a1.x<aU.map.width-15)&&(a1.y>30&&a1.y<aU.map.height-15))||!aU._config.restrictDraggingArea){var aZ=aU.map.pixelToPoint(a1),a2={pixel:a1,point:aZ};aU.setPoint(aZ);if(!aU._dragstarted){aU.dispatchEvent(aV(a2,new aw("ondragstart").inherit(a3)));aU._dragstarted=true}aU.dispatchEvent(aV(a2,new aw("ondragging").inherit(a3)))}};this.dragEnd=function(aZ){if(aU.domElement&&aU.domElement.releaseCapture){aU.domElement.releaseCapture()}aU._isDragging=false;aU.map.temp._draggingMarker=null;l.un(document,"mousemove",aU.dragIng);l.un(document,"mouseup",aU.dragEnd);l.un(document,"touchmove",aU.dragIng);l.un(document,"touchend",aU.dragEnd);e=aY=0;if((new Date()).getTime()-aT>=100&&(aW.x>2||aW.y>2)){aU._dragstarted=false;aU.dispatchEvent(aV({pixel:aU.map.pointToPixel(aU.getPoint()),point:aU.getPoint()},new aw("ondragend").inherit(aZ)))}aU._updateDomZIndex()};l.on(this.domElement,"mousedown",this.dragStart);l.on(this.domElement,"touchstart",this.dragStart)},enableDragging:function(e){this._config.enableDragging=true},disableDragging:function(){this._config.enableDragging=false},setPoint:function(e){if(e&&e.toString()=="Point"){this.point=this._config.point=new f(e.lng,e.lat);this.draw()}},_updateDomZIndex:function(){var i=this,e;if(i._isDragging==true){e=J.DRAG_ZINDEX}else{if(i._config.isTop==true){e=J.TOP_ZINDEX+(i._addi||0)}else{if(typeof i.zIndex!="undefined"){e=i.zIndex}else{e=0;if(i.map&&i.getPoint()){e=O.getZIndex(i.getPoint().lat,i.map.config.coordType)+i._config.baseZIndex}}}}if(i.domElement){i.domElement.style.zIndex=e}if(i.siblingElement){i.siblingElement.style.zIndex=e}},setTop:function(i,e){this._config.isTop=!!i;if(i){this._addi=e||0}this._updateDomZIndex()},setTitle:function(e){this._config.title=e;if(this.domElement){this.domElement.title=e||""}},getTitle:function(){return this._config.title||""},setOffset:function(e){if(!e||e.toString()!="Size"){return}this._config.offset=e;this.setPoint(this.getPoint())},getOffset:function(){return this._config.offset}});var R=w.prototype;R.getHTML=function(){if(l.Browser.ie==6&&this.imageUrl.toLowerCase().indexOf(".png")>0){var e=["<div"];if(this.printImageUrl){e.push(\' class="BMap_noprint"\')}e.push(\' style="width: 1px; height: 1px;\');e.push("; left:"+this.imageOffset.width+"px");e.push("; top:"+this.imageOffset.height+"px");e.push("; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=image,src=\'"+this.imageUrl+"\')");e.push(\'; position:absolute;"></div>\');if(this.printImageUrl){e.push(\'<img class="BMap_noscreen" style="border:none;left:\'+this.imageOffset.width+"px;");e.push("top:"+this.imageOffset.height+\'px;position:absolute" src="\'+this.printImageUrl+\'" />\')}return e.join("")}else{return[\'<img src="\',this.imageUrl,\'" style="border:none;left:\'+this.imageOffset.width+"px","; top:"+this.imageOffset.height+"px",\'; position:absolute;" />\'].join("")}};l.extend(q.prototype,{_addDom:function(){var i=this._config;var aU=this.content;var e=t("label",{"class":"BMapLabel",unselectable:"on"});if(i.title){e.title=i.title}var aT=e.style;aT.position="absolute";aT.MozUserSelect="none";if(i.width==0||i.width=="auto"){aT.display="inline"}else{aT.width=i.width+"px";aT.display="block";aT.overflow="hidden"}if(i.clickable=="true"){aT.cursor="pointer"}else{if(!l.Browser.ie){aT.cursor="inherit"}}e.innerHTML=aU;this.map.getPanes().labelPane.appendChild(e);this.domElement=e;this.setStyle(i.styles);return e},setPoint:function(e){if(e&&e.toString()=="Point"&&!this.getMarker()){this.point=this._config.point=new f(e.lng,e.lat);this.draw()}},draw:function(){if(this.domElement&&this.getPoint()&&!this.getMarker()){var i=this._config.offset||new X(0,0);var e=this.map.pointToOverlayPixel(this.getPoint());this.domElement.style.left=(e.x+i.width)+"px";this.domElement.style.top=(e.y+i.height)+"px";this._updateDomZIndex()}},_draw:function(){if(this.map&&!this._marker){this.domElement=this.initialize(this.map);this.draw()}},setContent:function(e){this.content=e;if(this.domElement){this.domElement.innerHTML=e}},setOpacity:function(e){if(e>=0&&e<=1){this._config.opacity=e}if(this.domElement){B(this.domElement,e)}},setOffset:function(e){if(!e||e.toString()!="Size"){return}this._config.offset=new X(e.width,e.height);if(this.getMarker()&&this.domElement){this.domElement.style.left=e.width+"px";this.domElement.style.top=e.height+"px"}else{this.draw()}},setStyle:function(i){i=i||{};this._config.styles=l.extend(this._config.styles,i);if(this.domElement){for(var aU in i){try{this.domElement.style[aU]=i[aU]}catch(aT){}}}},setTitle:function(e){this._config.title=e||"";if(this.domElement){this.domElement.title=this._config.title}}});');